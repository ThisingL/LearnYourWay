# 学习素材生成（含移动端渲染契约）

目标：基于个性化后的基础文本，生成多种学习形式：沉浸式文本、章节测验、思维导图，并在 Flutter 客户端稳定渲染与交互。

## 任务清单
1. 模块化生成器接口（`generate(type, input, options)`）
2. 沉浸式文本生成器（含插图占位）
3. 章节测验生成器（多选/判断/简答，含参考答案与点评）
4. 思维导图生成器（节点/边 JSON，供客户端渲染）
5. 质量评测与去偏/去毒守护
6. 客户端渲染契约与容错

## 实现与提示词

### 1) 生成器接口
- 提示词：
  - “实现统一生成器接口，新增素材仅需新增一个 `strategy`。”
- 测试：不同 `type` 路由正确，异常类型抛错。

### 2) 沉浸式文本
- 提示词：
  - “将章节重写为分节的沉浸式文本，保留关键定义；为插图留出 `{{image:desc}}` 占位；输出 JSON：`sections[{title, paragraphs[]}]`。”
- 客户端：用 `ListView` 渲染分节；识别 `{{image:...}}` 占位，替换为图片占位组件。
- 测试：结构校验 + 客户端 golden 测试（不同字体缩放）。

### 3) 章节测验
- 提示词：
  - “生成 8-12 道题，类型覆盖多选/判断/简答；提供 `answer` 与 `explanation`；题目紧贴本章概念。”
- 输出契约（示例）：
  - `questions[{id,type,stem,options[],answer,explanation,difficulty}]`
- 客户端：统一题目渲染器与评分；错误高亮与解析折叠。
- 测试：
  - JSON Schema 校验；
  - 干扰项多样性与难度分布；
  - 客户端 widget 测试评分逻辑。

### 4) 思维导图
- 提示词：
  - “输出 `nodes[]` 与 `edges[]` 的 JSON，节点含 `id,label,type`，边含 `source,target,label`。”
- 客户端：使用 `graphview`/自研画布渲染；支持缩放/拖拽/聚焦。
- 测试：拓扑连通性、无悬空节点、关键概念覆盖；客户端交互测试。

## 验收
- 三种素材均可稳定生成并在移动端渲染；
- 结构化校验通过，客户端 golden 测试与交互测试通过；
- 性能：长章节滚动流畅，导图操作不卡顿（60fps 目标）。

