# 移动端应用与测试（Flutter/原生）

目标：提供 Flutter 客户端，采集用户画像（年级/兴趣），展示个性化文本与学习素材，并支持章节测验的交互作答与评分；必要时通过 Platform Channels 接入原生能力（文件选择、通知等）。

## 任务清单
1. 路由结构与页面：画像表单、内容浏览、测验作答、导图预览、解析进度
2. 状态管理：`Riverpod/Bloc` 管理 `profile`、`personalizedText`、`materials`、`ingestTask`
3. 数据访问：`Dio` + 拦截器（鉴权、重试、日志），离线缓存 `hive/sqflite`
4. 权限与文件：文件选择、存储访问、通知权限（Android/iOS 差异）
5. 测试：Widget/Golden/Integration/E2E（Patrol）

## 实现要点
- 路由：`go_router` 分 `/:home -> profile -> materials -> quiz -> mindmap`；
- 表单：`Form` + `Riverpod`；
- 列表：长列表优化（`ListView.builder`，缓存 extent）；
- 进度：轮询解析任务 + 指数退避；
- 错误：统一错误页与重试；
- 无障碍：TalkBack/VoiceOver 标签与序列。

## 测试
- Widget：表单校验、题目渲染、导图组件；
- Golden：不同字体缩放/暗色模式；
- Integration：上传 PDF -> 查看解析 -> 个性化 -> 素材生成 -> 测验作答；
- E2E：Patrol/集成测试方案联通真机/模拟器；
- 性能：`flutter run --profile` + DevTools 帧率监控，关键页面 60fps。

## 打包与签名
- Android：`app/build.gradle`、签名配置、`bundle` 产物；
- iOS：Bundle ID、证书、Provisioning Profile、`flutter build ipa`。

